<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="数据科学, 数据分析, 产品需求分析, 云计算, 项目管理, slash" />





  <link rel="alternate" href="/atom.xml" title="Busihacker" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="[toc]

需求：
基于 web 的 itervactive debug
公网访问的 Web Python解析脚本
支持更强大、可视化和可交互的文档

Brief of 解决方案
部署IPyhon/Jupyter Notebook到服务器
购买域名并绑定到服务器
和Markdown/Rmarkdown结合（未完成）">
<meta property="og:type" content="article">
<meta property="og:title" content="部署Jupyter/IPython Notebook Memo">
<meta property="og:url" content="http://noragithub.github.io#http://yoursite.com/2016/09/24/部署Jupyter-IPython-Notebook-Memo/index.html">
<meta property="og:site_name" content="Busihacker">
<meta property="og:description" content="[toc]

需求：
基于 web 的 itervactive debug
公网访问的 Web Python解析脚本
支持更强大、可视化和可交互的文档

Brief of 解决方案
部署IPyhon/Jupyter Notebook到服务器
购买域名并绑定到服务器
和Markdown/Rmarkdown结合（未完成）">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/544981-7dfe26d822e0a207.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/544981-e8e04b9a5dfb0f0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/544981-a6705a8eea965001.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/544981-afc57132a6f87c12.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/544981-cf639bfbabfce7ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/544981-e3161f7f19f080e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/544981-d82d9ca02a61676b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2016-11-22T15:30:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="部署Jupyter/IPython Notebook Memo">
<meta name="twitter:description" content="[toc]

需求：
基于 web 的 itervactive debug
公网访问的 Web Python解析脚本
支持更强大、可视化和可交互的文档

Brief of 解决方案
部署IPyhon/Jupyter Notebook到服务器
购买域名并绑定到服务器
和Markdown/Rmarkdown结合（未完成）">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/544981-7dfe26d822e0a207.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 8461498,
      author: 'Nora'
    }
  };
</script>

  <title> 部署Jupyter/IPython Notebook Memo | Busihacker </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47491561-3', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?f26ede084ad338bcf34fc178c615fcb5";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Busihacker</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                部署Jupyter/IPython Notebook Memo
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-24T20:55:44+08:00" content="2016-09-24">
              2016-09-24
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/24/部署Jupyter-IPython-Notebook-Memo/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/24/部署Jupyter-IPython-Notebook-Memo/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>[toc]</p>
<hr>
<h1 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h1><ol>
<li>基于 web 的 itervactive debug</li>
<li>公网访问的 Web Python解析脚本</li>
<li>支持更强大、可视化和可交互的文档</li>
</ol>
<h1 id="Brief-of-解决方案"><a href="#Brief-of-解决方案" class="headerlink" title="Brief of 解决方案"></a>Brief of 解决方案</h1><ol>
<li>部署IPyhon/Jupyter Notebook到服务器</li>
<li>购买域名并绑定到服务器</li>
<li>和Markdown/Rmarkdown结合（未完成）</li>
</ol>
<a id="more"></a>
<hr>
<h1 id="IPython-和-Jupyter"><a href="#IPython-和-Jupyter" class="headerlink" title="IPython 和 Jupyter"></a>IPython 和 Jupyter</h1><p><code>IPython</code> 通常指的是一个 Python REPL(交互式解释器) shell。提供了远比 Python shell 强大的 shell 环境。<code>IPython</code> 是 Iteractive Python shell 的缩写。 Notebook 是一个基于 IPython 的 web 应用。 </p>
<p>截止 IPython 3.0 ，IPython 变得越来越臃肿，因此， IPython 4.x 后，IPython被分离成为了IPython kernel’s Jupyter（IPython shell combined with jupyter kernel） 和Jupyter subprojects ，Notebook 是 Jupyter 的一个 subproject 。官方将此称为<code>The Big Split™</code>。<a href="http://blog.jupyter.org/2015/04/15/the-big-split/" target="_blank" rel="external">#reference-The Big Split™</a></p>
<p>IPython 把与语言无关（language-agnostic）的 components 和 Python 解释器剥离，独立为<code>Jupyter</code>发行。因此，Jupyter 可以和 Python 之外的解析器结合，提供新的、强大的服务。比如 Ruby REPL 环境 IRuby 和 Julia REPL 环境 IJulia。</p>
<p>因此，Jupyter 和  IPyhon 指代同一个项目， Jupyter 特指  Ipython4 后的， 非python kernel框架。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/544981-7dfe26d822e0a207.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="IPython 和 Jupyter"></p>
<h2 id="Jupyter的架构"><a href="#Jupyter的架构" class="headerlink" title="Jupyter的架构"></a>Jupyter的架构</h2><p><img src="http://upload-images.jianshu.io/upload_images/544981-e8e04b9a5dfb0f0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="A Visual Overview of Projects"><br><a href="http://jupyter.readthedocs.io/en/latest/architecture/visual_overview.html" target="_blank" rel="external">#reference-A Visual Overview of Projects</a></p>
<h2 id="怎么选择Jupyter下的子项目"><a href="#怎么选择Jupyter下的子项目" class="headerlink" title="怎么选择Jupyter下的子项目"></a>怎么选择Jupyter下的子项目</h2><p><img src="http://upload-images.jianshu.io/upload_images/544981-a6705a8eea965001.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="How do I decide which packages I need?"></p>
<p><a href="http://jupyter.readthedocs.io/en/latest/projects/content-projects.html" target="_blank" rel="external">#reference-How do I decide which packages I need?</a></p>
<h3 id="nbviewer"><a href="#nbviewer" class="headerlink" title="nbviewer"></a>nbviewer</h3><p>IPython 运行结果可以单独保存，格式为 .ipynb 。<code>nbviewer</code>是 Jupyter notebook viewer 的缩写，用于渲染 .ipynb 文件，并支持 HTML 和 PDF 输出。现 GitHub 已提供 Notebook 的在线预览。</p>
<hr>
<h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><h2 id="服务器-amp-操作系统"><a href="#服务器-amp-操作系统" class="headerlink" title="服务器&amp;操作系统"></a>服务器&amp;操作系统</h2><p><a href="http://bandwagonhost.com" target="_blank" rel="external">bandwagonhost</a>的VPS</p>
<p>配置：</p>
<blockquote>
<p>1CPU<br>256 MB Memory<br>10 GB Disk(SSD)<br>Ubuntu 16.04 x86_64<br>500GB Transfer/Bandwidth</p>
</blockquote>
<h1 id="Jupyter-IPython"><a href="#Jupyter-IPython" class="headerlink" title="Jupyter / IPython"></a>Jupyter / IPython</h1><h2 id="安装Notebook"><a href="#安装Notebook" class="headerlink" title="安装Notebook"></a>安装Notebook</h2><p>本文通过安装Canopy的发行版本实现Jupyter / IPython安装。<br>Canopy是一个科学计算的python发行版本。包括了需要的依赖package，包括IPython、Jupiter、<a href="http://www.tornadoweb.org/en/stable/" target="_blank" rel="external">Tornado</a>（web服务器）以及其他科学计算库，例如Numpy、Scipy、Matplotlib等。</p>
<p>因为在服务器端，这里有两种方案可用于下载并安装Canopy。</p>
<ul>
<li>最简单直接方案，服务器下载并安装：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Canopy -&gt;&gt; Server : wget</div><div class="line">Server -&gt;&gt; Server : install</div></pre></td></tr></table></figure>
</li>
</ul>
<p>由于服务器端wget命令出现是否支持SSL协议、403 forbidden、超时 等一系列问题，实际采用的方案是：</p>
<ul>
<li>先下载到本地再上传到服务器安装：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Canopy -&gt;&gt; Client : download</div><div class="line">Client -&gt;&gt; Server : scp</div><div class="line">Server -&gt;&gt; Server : install</div></pre></td></tr></table></figure>
<h3 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h3><p>Canopy下载<a href="https://store.enthought.com/downloads/#default" target="_blank" rel="external">地址</a>，选择合适版本即可。</p>
<h3 id="SSH-协议上传到服务器"><a href="#SSH-协议上传到服务器" class="headerlink" title="SSH 协议上传到服务器"></a>SSH 协议上传到服务器</h3><p>先在服务器mkdir目录。</p>
<blockquote>
<p>\$ mkdir path/to/save/server/canopy  </p>
</blockquote>
<p>再把本地文件通过 SSH 协议上传到服务器</p>
<blockquote>
<p>\$  scp -P &lt;%服务端SSH端口&gt; path/to/save/local/canopy/&lt;canopy-to-insall&gt;.sh &lt;%服务端user-name&gt;@&lt;%服务器IP&gt;:path/to/save/server/canopy </p>
</blockquote>
<p><a href="http://www.cnblogs.com/jiangyao/archive/2011/01/26/1945570.html" target="_blank" rel="external">#reference-利用ssh传输文件</a></p>
<h3 id="安装Canopy"><a href="#安装Canopy" class="headerlink" title="安装Canopy"></a>安装Canopy</h3><p><strong>建议安装前先执行<a href="#可能遇到的问题">可能遇到的问题</a>脚本,以防万一。</strong></p>
<p>执行安装</p>
<blockquote>
<p>\$ bash path/to/save/server/canopy/&lt;canopy-to-insall&gt;.sh </p>
</blockquote>
<h3 id="初始化-amp-激活Canopy"><a href="#初始化-amp-激活Canopy" class="headerlink" title="初始化&amp;激活Canopy"></a>初始化&amp;激活Canopy</h3><p>安装完后，得到以下信息</p>
<blockquote>
<p>You can run the Canopy graphical environment by running the script:<br>/root/Canopy/canopy<br>or by selecting ‘Canopy’ in your Applications menu.<br>On your first run, your Canopy User Python environment will be initialized, and you will have the opportunity to make Canopy be your default Python at the command line. Details at support.enthought.com/forums</p>
<p>Thank you for installing Canopy!</p>
</blockquote>
<p>由于我不需要graphical environment，因此我们执行<code>~/Canopy/canopy_cli --no-gui-setup setup ~/canopy</code>配置EPD-like environment即可<br><a href="#id">reference-【译】安装Canopy</a><br><a href="http://docs.enthought.com/canopy/quick-start/install_linux.html" target="_blank" rel="external">reference-Install Linux</a></p>
<h3 id="Option"><a href="#Option" class="headerlink" title="Option"></a>Option</h3><h4 id="防火墙转发"><a href="#防火墙转发" class="headerlink" title="防火墙转发"></a>防火墙转发</h4><p>由于Ubuntu默认未启动防火墙，需要的可以看一下这里：</p>
<blockquote>
<p>To function correctly, the firewall on the computer running the ipython server must be configured to allow connections from client machines on the <code>c.NotebookApp.port</code> port to allow connections to the web interface. The firewall must also allow connections from 127.0.0.1 (localhost) on ports from 49152 to 65535. These ports are used by the server to communicate with the notebook kernels. The kernel communication ports are chosen randomly by ZeroMQ, and may require multiple connections per kernel, so a large range of ports must be accessible.</p>
</blockquote>
<p><a href="http://ipython.org/ipython-doc/stable/notebook/public_server.html#firewall-setup" target="_blank" rel="external">#reference-Firewall Setup</a></p>
<h4 id="存放文件目录"><a href="#存放文件目录" class="headerlink" title="存放文件目录"></a>存放文件目录</h4><p>哪个目录启动（执行<code>jupyter notebook --config=path/to/your/profile_root/profile_&lt;%profile_name&gt;/ipython_notebook_config.py</code>的目录），进入后web后就显示哪个目录里面的文件，也会在该目录存放所有文件。可以自行设置更改，我<code>mkdir</code>了一个<code>server_doc_to_save</code>文件夹使用。</p>
<h4 id="后台运行"><a href="#后台运行" class="headerlink" title="后台运行"></a>后台运行</h4><p>至此，有一个问题是，客户端logout之后，服务器的进程会killed，需要保证服务器在logout之后依然运行。当然需要保留想办法保留这个进程的日志。</p>
<blockquote>
<p>\$ nohup &lt;语句&gt; &amp;</p>
</blockquote>
<p>原程序的的标准输出被自动改向到当前目录下的nohup.out文件，起到了log的作用。<br><a href="http://www.cnblogs.com/allenblogs/archive/2011/05/19/2051136.html" target="_blank" rel="external">#reference-linux的nohup命令的用法</a><br><a href="https://www.ibm.com/developerworks/cn/linux/l-cn-nohup/" target="_blank" rel="external">#reference-Linux 技巧：让进程在后台可靠运行的几种方法</a></p>
<h4 id="Bookstore"><a href="#Bookstore" class="headerlink" title="Bookstore"></a>Bookstore</h4><blockquote>
<p>By default, the notebook server stores the notebook documents that it saves as files in the working directory of the notebook server, also known as the <code>notebook_dir</code>. This logic is implemented in the FileNotebookManager<br> class. However, the server can be configured to use a different notebook manager class, which can store the notebooks in a different format.<br>The <a href="https://github.com/rgbkrk/bookstore" target="_blank" rel="external">bookstore</a> package currently allows users to store notebooks on Rackspace CloudFiles or OpenStack Swift based object stores.<br>Writing a notebook manager is as simple as extending the base class NotebookManager.The <a href="https://github.com/khinsen/simple_notebook_manager" target="_blank" rel="external">simple_notebook_manager</a> provides a great example of an in memory notebook manager, created solely for the purpose of illustrating the notebook manager API.</p>
</blockquote>
<p><a href="http://ipython.org/ipython-doc/stable/notebook/public_server.html#using-a-different-notebook-store" target="_blank" rel="external">#reference-Using a different notebook store</a></p>
<h2 id="启动-Notebook"><a href="#启动-Notebook" class="headerlink" title="启动 Notebook"></a>启动 Notebook</h2><p><a href="http://jupyter-notebook.readthedocs.io/en/latest/public_server.html" target="_blank" rel="external">#reference-Jupyter Notebook 配置</a></p>
<h3 id="profile"><a href="#profile" class="headerlink" title="profile"></a>profile</h3><h4 id="IPython-4以前"><a href="#IPython-4以前" class="headerlink" title="IPython 4以前"></a>IPython 4以前</h4><p>通过新建 profile ，每个profile可以有独立的配置</p>
<blockquote>
<p>\$ ipython profile create &lt;profile-name&gt;# 创建一个新的notebook profile，命名为 &lt;profile-name&gt;</p>
</blockquote>
<p>配置文件路径<code>~/.ipython/profile_&lt;profile-name&gt;/ipython_notebook_config.py</code></p>
<h4 id="Jupyter"><a href="#Jupyter" class="headerlink" title="Jupyter"></a>Jupyter</h4><p>Jupyter 没有 profile 概念了，只有默认配置，在<code>~/.jupyter/jupyter_notebook_config.py</code>。但个人认为 profile 概念非常好的，独立于默认配置，耦合性低。所以会自己按照IPython的处理方式模拟出profile。</p>
<blockquote>
<p>\$ mkdir path/to/your/profile_root/profile_&lt;%profile_name&gt; # 为profile创建目录<br>\$ cp -i ~/.jupyter/jupyter_notebook_config.py path/to/your/profile_root/profile_&lt;%profile_name&gt; # 复制默认配置 到 profile 中作为初始配置<br>\$ mv jupyter_notebook_config.py ipython_notebook_config.py# 重命名为ipython_notebook_config.py，方便自己记忆，这是模拟的ipython</p>
</blockquote>
<p>至此，基于web，支持HTTP协议的Jupyter Notebook 服务完成部署了。执行<code>jupyter notebook --config=path/to/your/profile_root/profile_&lt;%profile_name&gt;/ipython_notebook_config.py</code>，然后访问你的IP：<code>http://&lt;your-ip&gt;:8888</code>即可。</p>
<p><strong>PS：</strong><br><code>jupyter notebook --config=path/to/your/profile_root/profile_&lt;%profile_name&gt;/ipython_notebook_config.py</code>和直接运行 <code>jupyter notebook --port=9999 --ip=&#39;*&#39;</code> 效果完全一样。</p>
<p><a href="https://ipython.org/ipython-doc/3/config/intro.html#profiles" target="_blank" rel="external">#reference-Porfiles</a><br><a href="http://jupyter.readthedocs.io/en/latest/migrating.html#id8" target="_blank" rel="external">#reference-Since Jupyter does not have profiles, how do I customize it?</a><br><a href="http://stackoverflow.com/questions/31962862/ipython-ipython-notebook-config-py-missing" target="_blank" rel="external">#reference-IPython - ipython_notebook_config.py missing</a><br><a href="http://stackoverflow.com/questions/32071672/where-should-i-place-my-settings-and-profiles-for-use-with-ipython-jupyter-4-0" target="_blank" rel="external">#reference-Where should I place my settings and profiles for use with IPython/Jupyter 4.0?</a><br><a href="http://stackoverflow.com/questions/32320836/how-do-i-get-ipython-profile-behavior-from-jupyter-4-x" target="_blank" rel="external">#reference-How do I get IPython profile behavior from Jupyter 4.x?</a><br><a href="https://github.com/ipython/ipython/issues/8818" target="_blank" rel="external">#reference-jupyter配置ipython notebook not creating/ignoring settings in ‘ipython_notebook_config.py’ #8818</a><br><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-jupyter-notebook-to-run-ipython-on-ubuntu-16-04" target="_blank" rel="external">#reference-how to set up a jupyter notebook to run python on ubuntu 16.04</a></p>
<h2 id="Option-1"><a href="#Option-1" class="headerlink" title="Option"></a>Option</h2><h3 id="设置登录密码"><a href="#设置登录密码" class="headerlink" title="设置登录密码"></a>设置登录密码</h3><blockquote>
<p>In [1]: from IPython.lib import passwd<br>In [2]: passwd()<br>Enter password:<br>Verify password:<br>Out[2]: ‘sha1:&lt;your-hash-passwd&gt;’</p>
</blockquote>
<p>输入两次密码后（用来登录Jupyter的密码），就会输出一个哈希密钥。profile应该知道这个密钥，因此编辑profile配置：</p>
<blockquote>
<p>$ vi path/to/your/profile_root/profile_&lt;%profile_name&gt;/ipython_notebook_config.py</p>
</blockquote>
<p>i（insert）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">c.NotebookApp.password = u&apos;sha1:&lt;your-hash-passwd&gt;&apos;</div></pre></td></tr></table></figure>
<p>执行<code>jupyter notebook --config=path/to/your/profile_root/profile_&lt;%profile_name&gt;/ipython_notebook_config.py</code>，然后输入密码访问：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/544981-afc57132a6f87c12.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="密码登录.png"></p>
<h3 id="修改默认访问端口"><a href="#修改默认访问端口" class="headerlink" title="修改默认访问端口"></a>修改默认访问端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># It&apos;s a good idea to put it on a known, fixed port</div><div class="line">c.NotebookApp.port = 9999 # 默认端口8888</div></pre></td></tr></table></figure>
<h3 id="SSL协议访问"><a href="#SSL协议访问" class="headerlink" title="SSL协议访问"></a>SSL协议访问</h3><p>SSL协议访问需要证书，一般需要通过第三方颁发/认证。为求方便，这里自己为自己颁发/认证，这个证书为一个pem文件。</p>
<blockquote>
<p>\$ openssl req -x509 -nodes -days 365 -newkey rsa:1024 -keyout mycert.pem -out mycert.pem</p>
</blockquote>
<p>执行后，在当前路径生成一个 mycert.pem 文件。</p>
<p>修改profile 的配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 证书地址，获取第三方认证证书后，修改即可</div><div class="line">c.NotebookApp.certfile = u&apos;/root/mycert.pem&apos;</div></pre></td></tr></table></figure></p>
<p>执行<code>ipython notebook --profile=nbserver</code>然后访问你的IP，记得要加https：<code>https://&lt;your-ip&gt;:9999</code></p>
<p><a href="#e">reference-SSL的原理，充当裁判的角色</a><br>这里的使用的是自签名证书（Self-Signed Certificate），由于未经过第三方认证。以下现象都是正常的，使用经过认证的证书即可。<br><img src="http://upload-images.jianshu.io/upload_images/544981-cf639bfbabfce7ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="HTTPS 警告"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/544981-e3161f7f19f080e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Not Private"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/544981-d82d9ca02a61676b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Security Overview"></p>
<p><a href="http://jupyter-notebook.readthedocs.io/en/latest/public_server.html" target="_blank" rel="external">#reference-Jupyter Notebook 配置</a><br><a href="http://arstechnica.com/security/2009/12/how-to-get-set-with-a-secure-sertificate-for-free/" target="_blank" rel="external">#reference-支持三方认证的SSL</a><br><a href="https://letsencrypt.org/" target="_blank" rel="external">#reference-三方机构Let’s Encrypt</a><br><a href="https://www.startssl.com" target="_blank" rel="external">#reference-三方机构StartSSL</a></p>
<h3 id="其他配置"><a href="#其他配置" class="headerlink" title="其他配置"></a>其他配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"># 谨慎出现中文</div><div class="line"># c = get_config() # 这一行并非必须有</div><div class="line"></div><div class="line"># Kernel config</div><div class="line">c.IPKernelApp.pylab = &apos;inline&apos;  # if you want plotting support always</div><div class="line"></div><div class="line"># Notebook config</div><div class="line">c.NotebookApp.certfile = u&apos;/root/mycert.pem&apos;</div><div class="line">c.NotebookApp.password = u&apos;sha1:&lt;your-hash-passwd&gt;&apos;</div><div class="line"># It&apos;s a good idea to put it on a known, fixed port</div><div class="line">c.NotebookApp.port = 9999 # 默认端口8888</div><div class="line"></div><div class="line">c.NotebookApp.ip = &apos;*&apos; # 接受访问的ip</div><div class="line">c.NotebookApp.open_browser = False # 启动后默认打开浏览器</div><div class="line"></div><div class="line">...</div></pre></td></tr></table></figure>
<p><a href="http://jupyter-notebook.readthedocs.io/en/latest/config.html" target="_blank" rel="external">#reference-Config file and command line options</a><br><a href="http://mindonmind.github.io/2013/02/08/ipython-notebook-interactive-computing-new-era/#fn4" target="_blank" rel="external">#reference-IPython Notebook: 交互计算新时代</a><br>校正：<br>这篇reference，有一个错误，以下用#标记了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">c.IPKernerlApp.pylab = &apos;inline&apos;</div><div class="line">c.NotebookApp.ip = &apos;*&apos;</div><div class="line">c.NotebookApp.open_browser = False</div><div class="line">c.NotebookApp.password = u&apos;sha1:xxxx your hashed password&apos;</div><div class="line">c.NotebookApp.port = 9999 #可设为其他端口</div><div class="line">#c.Notebook.App.port = 9999 #可设为其他端口</div></pre></td></tr></table></figure></p>
<h1 id="IPython-到-Jupyter-的兼容-迁移（migrate）"><a href="#IPython-到-Jupyter-的兼容-迁移（migrate）" class="headerlink" title="IPython 到 Jupyter 的兼容/迁移（migrate）"></a>IPython 到 Jupyter 的兼容/迁移（migrate）</h1><p>通过执行<code>jupyter migrate</code>自动迁移配置<br>|解析语言|默认目录|<br>|:–:|:–:|<br>|IPython|~/.ipython|<br>|Jupyter|~/.jupyter|</p>
<table>
<thead>
<tr>
<th style="text-align:center">IPython location</th>
<th style="text-align:center">Jupyter location</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">~/.ipython/profile_default/static/custom</td>
<td style="text-align:center">~/.jupyter/custom</td>
</tr>
<tr>
<td style="text-align:center">~/.ipython/profile_default/ipython_notebook_config.py</td>
<td style="text-align:center">~/.jupyter/jupyter_notebook_config.py</td>
</tr>
<tr>
<td style="text-align:center">~/.ipython/profile_default/ipython_nbconvert_config.py</td>
<td style="text-align:center">~/.jupyter/jupyter_nbconvert_config.py</td>
</tr>
<tr>
<td style="text-align:center">~/.ipython/profile_default/ipython_qtconsole_config.py</td>
<td style="text-align:center">~/.jupyter/jupyter_qtconsole_config.py</td>
</tr>
<tr>
<td style="text-align:center">~/.ipython/profile_default/ipython_console_config.py</td>
<td style="text-align:center">~/.jupyter/jupyter_console_config.py</td>
</tr>
</tbody>
</table>
<p>这片reference阐述了从IPython 到 Jupyter的配置改变及如何兼容<br><a href="http://jupyter.readthedocs.io/en/latest/migrating.html" target="_blank" rel="external">Migrating from IPython Notebook</a></p>
<h1 id="可能遇到的问题"><a href="#可能遇到的问题" class="headerlink" title="可能遇到的问题"></a>可能遇到的问题</h1><h2 id="升级apt-get"><a href="#升级apt-get" class="headerlink" title="升级apt-get"></a>升级apt-get</h2><p>更新资源并升级：</p>
<blockquote>
<p>\$ sudo apt-get update &amp;&amp; sudo apt-get upgrade</p>
</blockquote>
<h2 id="包依赖1"><a href="#包依赖1" class="headerlink" title="包依赖1"></a>包依赖1</h2><blockquote>
<p>desktop-file-install:command not found<br>update-desktop-database command not found</p>
</blockquote>
<p>解决</p>
<blockquote>
<p>\$ sudo apt-get install desktop-file-utils</p>
</blockquote>
<p><a href="https://www.google.com.hk/search?ie=utf-8&amp;oe=UTF-8&amp;hl=zh-CN&amp;q=desktop-file-install%3A+command+not+found&amp;gws_rd=ssl" target="_blank" rel="external">#reference-desktop-file-install:command not found</a></p>
<h2 id="包依赖2"><a href="#包依赖2" class="headerlink" title="包依赖2"></a>包依赖2</h2><blockquote>
<p>update-mime-database: command not found</p>
</blockquote>
<h2 id="系统语言1"><a href="#系统语言1" class="headerlink" title="系统语言1"></a>系统语言1</h2><p>SSH连接上服务器，会传递部分变量，由于服务端和客户端变量（eg.LANG）冲突，可以选择注释掉locale setting（SSH服务端配置地址：<code>/etc/ssh/sshd_config</code>）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># AcceptEnv LANG LC_*</div></pre></td></tr></table></figure></p>
<p><a href="http://stackoverflow.com/questions/2499794/how-can-i-fix-a-locale-warning-from-perl" target="_blank" rel="external">#reference-How can I fix a locale warning from perl</a></p>
<h2 id="系统语言2"><a href="#系统语言2" class="headerlink" title="系统语言2"></a>系统语言2</h2><p>安装过程中，Ubuntu系统语言不支持en_US.UTF-8，需要支持:</p>
<blockquote>
<p>\$ sudo locale-gen en_US.UTF-8</p>
</blockquote>
<p><a href="http://wiki.ubuntu.org.cn/%E4%BF%AE%E6%94%B9locale" target="_blank" rel="external">#reference-将Ubuntu系统语言环境改为英文的en_US.UTF-8</a></p>
<h2 id="设置-timezone"><a href="#设置-timezone" class="headerlink" title="设置 timezone"></a>设置 timezone</h2><blockquote>
<p>\$ dpkg-reconfigure tzdata</p>
</blockquote>
<h2 id="could-not-connect-to-X-server"><a href="#could-not-connect-to-X-server" class="headerlink" title="could not connect to X server"></a>could not connect to X server</h2><p>当运行<code>/root/Canopy/canopy</code>企图使用graphical environment的时候，会显示<code>could not connect to X server</code>问题，可能是GUI或者权限问题</p>
<p><a href="#.">#reference-Ubuntu服务端GUI配置</a></p>
<hr>
<h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>如不特殊声明，本文大部分脚本在服务端执行。</p>

      
    </div>

    <div>
      
        
<div id="wechat_subscriber" style="display: block； padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="http://of2r0f294.bkt.clouddn.com/20161123-wehchatsubscriber.png_narrow" alt="Nora Chan wechat" style="width: 200px; max-width: 100%;"/>
    <div>我的微信号</div>
</div>

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>您的支持将鼓励我继续创作！</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="http://of2r0f294.bkt.clouddn.com/20161123-wechatpay.png_narrow" alt="Nora Chan WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="http://of2r0f294.bkt.clouddn.com/20161123-alipay.png_narrow" alt="Nora Chan Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/07/30/test-diagram/" rel="next" title="test diagram">
                <i class="fa fa-chevron-left"></i> test diagram
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/09/29/README/" rel="prev" title="">
                 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2016/09/24/部署Jupyter-IPython-Notebook-Memo/"
     data-title="部署Jupyter/IPython Notebook Memo"
     data-content=""
     data-url="http://noragithub.github.io#http://yoursite.com/2016/09/24/部署Jupyter-IPython-Notebook-Memo/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/09/24/部署Jupyter-IPython-Notebook-Memo/"
           data-title="部署Jupyter/IPython Notebook Memo" data-url="http://noragithub.github.io#http://yoursite.com/2016/09/24/部署Jupyter-IPython-Notebook-Memo/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://ww3.sinaimg.cn/mw690/6fa34428jw8eyydwfqrecj20ro0ro42v.jpg"
               alt="Nora Chan" />
          <p class="site-author-name" itemprop="name">Nora Chan</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">20</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/NoraGithub" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/users/06ff1db1651f" target="_blank" title="简书">
                  
                    <i class="fa fa-fw fa-globe#jianshu"></i>
                  
                  简书
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/1872970792" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/Nora_Chan" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe#zhihu"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#需求："><span class="nav-number">1.</span> <span class="nav-text">需求：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Brief-of-解决方案"><span class="nav-number">2.</span> <span class="nav-text">Brief of 解决方案</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IPython-和-Jupyter"><span class="nav-number">3.</span> <span class="nav-text">IPython 和 Jupyter</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Jupyter的架构"><span class="nav-number">3.1.</span> <span class="nav-text">Jupyter的架构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#怎么选择Jupyter下的子项目"><span class="nav-number">3.2.</span> <span class="nav-text">怎么选择Jupyter下的子项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#nbviewer"><span class="nav-number">3.2.1.</span> <span class="nav-text">nbviewer</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#环境配置"><span class="nav-number">4.</span> <span class="nav-text">环境配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#服务器-amp-操作系统"><span class="nav-number">4.1.</span> <span class="nav-text">服务器&操作系统</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Jupyter-IPython"><span class="nav-number">5.</span> <span class="nav-text">Jupyter / IPython</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装Notebook"><span class="nav-number">5.1.</span> <span class="nav-text">安装Notebook</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Download"><span class="nav-number">5.1.1.</span> <span class="nav-text">Download</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SSH-协议上传到服务器"><span class="nav-number">5.1.2.</span> <span class="nav-text">SSH 协议上传到服务器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装Canopy"><span class="nav-number">5.1.3.</span> <span class="nav-text">安装Canopy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始化-amp-激活Canopy"><span class="nav-number">5.1.4.</span> <span class="nav-text">初始化&激活Canopy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Option"><span class="nav-number">5.1.5.</span> <span class="nav-text">Option</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#防火墙转发"><span class="nav-number">5.1.5.1.</span> <span class="nav-text">防火墙转发</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#存放文件目录"><span class="nav-number">5.1.5.2.</span> <span class="nav-text">存放文件目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#后台运行"><span class="nav-number">5.1.5.3.</span> <span class="nav-text">后台运行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bookstore"><span class="nav-number">5.1.5.4.</span> <span class="nav-text">Bookstore</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#启动-Notebook"><span class="nav-number">5.2.</span> <span class="nav-text">启动 Notebook</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#profile"><span class="nav-number">5.2.1.</span> <span class="nav-text">profile</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IPython-4以前"><span class="nav-number">5.2.1.1.</span> <span class="nav-text">IPython 4以前</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Jupyter"><span class="nav-number">5.2.1.2.</span> <span class="nav-text">Jupyter</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Option-1"><span class="nav-number">5.3.</span> <span class="nav-text">Option</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#设置登录密码"><span class="nav-number">5.3.1.</span> <span class="nav-text">设置登录密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改默认访问端口"><span class="nav-number">5.3.2.</span> <span class="nav-text">修改默认访问端口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SSL协议访问"><span class="nav-number">5.3.3.</span> <span class="nav-text">SSL协议访问</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其他配置"><span class="nav-number">5.3.4.</span> <span class="nav-text">其他配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IPython-到-Jupyter-的兼容-迁移（migrate）"><span class="nav-number">6.</span> <span class="nav-text">IPython 到 Jupyter 的兼容/迁移（migrate）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#可能遇到的问题"><span class="nav-number">7.</span> <span class="nav-text">可能遇到的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#升级apt-get"><span class="nav-number">7.1.</span> <span class="nav-text">升级apt-get</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#包依赖1"><span class="nav-number">7.2.</span> <span class="nav-text">包依赖1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#包依赖2"><span class="nav-number">7.3.</span> <span class="nav-text">包依赖2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#系统语言1"><span class="nav-number">7.4.</span> <span class="nav-text">系统语言1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#系统语言2"><span class="nav-number">7.5.</span> <span class="nav-text">系统语言2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设置-timezone"><span class="nav-number">7.6.</span> <span class="nav-text">设置 timezone</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#could-not-connect-to-X-server"><span class="nav-number">7.7.</span> <span class="nav-text">could not connect to X server</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#End"><span class="nav-number">8.</span> <span class="nav-text">End</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nora Chan</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"Nora"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
      
      <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
      <script src="/js/src/hook-duoshuo.js"></script>
    
  





  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  

  
<script type="text/javascript" async src="//push.zhanzhang.baidu.com/push.js">
</script>


</body>
</html>
